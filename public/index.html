<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pixie Event Tool</title>
  <link rel="stylesheet" href="styles.css">
</head>

<body>

  <div class="cursor-glow" id="glow"></div>

  <div class="container">
    <h2>Pixie Event Tool</h2>

    <div class="dropdown-wrapper">
      <select id="city">
        <option value="mumbai">Mumbai</option>
        <option value="delhi">Delhi</option>
        <option value="bangalore">Bangalore</option>
        <option value="pune">Pune</option>
        <option value="chennai">Chennai</option>
        <option value="hyderabad">Hyderabad</option>
        <option value="kolkata">Kolkata</option>
      </select>
    </div>

    <button class="btn primary" onclick="runScraper()">
      Fetch Events
    </button>

    <button class="btn secondary" onclick="downloadExcel()">
      Download Excel
    </button>

    <p class="status" id="status"></p>
    <p class="hint">
      Select a city → Fetch → then Download
    </p>
  </div>

  <script>
    const glow = document.getElementById("glow");

    document.addEventListener("mousemove", (e) => {
      glow.style.left = e.clientX + "px";
      glow.style.top = e.clientY + "px";
    });

    async function runScraper() {
      const city = document.getElementById("city").value;
      document.getElementById("status").innerText =
        "Scraping in progress... please wait";

      try {
        const res = await fetch(`/run-scraper?city=${city}`);
        const text = await res.text();
        document.getElementById("status").innerText = text;
      } catch (err) {
        document.getElementById("status").innerText =
          "Error running scraper";
      }
    }

    function downloadExcel() {
      const city = document.getElementById("city").value;
      window.location.href = `/download?city=${city}`;
    }
  </script>
</body>
</html>
